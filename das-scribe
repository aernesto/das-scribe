import argparse
import distutils.filelist
import markdown
import os.path
import sys

def CreateParser():
  parser = argparse.ArgumentParser(description='Static content blogging')
  parser.add_argument('input', metavar='post_dir', type=str)
  parser.add_argument('--output', metavar='output_dir', type=str, required=True)
  return parser

def GeneratePost(post_dir, output_dir):
  post_files = distutils.filelist.FileList(post_dir)
  post_files.include_pattern('*.md')
  for post_file in post_files.files:
    output_name = '%s.html' % post_file[:-3]
    target_file = os.path.join(output_dir, output_name)
    with open(target_file, 'w') as output_file:
      markdown.markdownFromFile(input=post_file, output=output_file)


def main(argv):
  parser = CreateParser()
  args = parser.parse_args(argv[1:])
  GeneratePost(args.input, args.output)

if __name__ == '__main__':
  main(sys.argv)
